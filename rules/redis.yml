groups:
  - name: Redis
    rules:
      - alert: Redis Down
        expr: redis_up == 0
        for: 5m
        labels:
          severity: error
        annotations:
          summary: "Redis down (instance {{ $labels.instance }})"
      - alert: Redis Missing Backup
        expr: time() - redis_rdb_last_save_timestamp_seconds > 60 * 60 * 24
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Missing backup for 24 hours (instance {{ $labels.instance }})"
      - alert: Redis Replication Broken
        expr: delta(redis_connected_slaves[1d]) < 0
        for: 5m
        labels:
          severity: error
        annotations:
          summary: "Replication broken (instance {{ $labels.instance }})"
      - alert: Redis Too Many Connections
        expr: redis_connected_clients > 100
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Too many connections (> 100) (instance {{ $labels.instance }})"
      - alert: Redis Not Enough Connections
        expr: redis_connected_clients < 5
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Not enough connections (instance {{ $labels.instance }})"
      - alert: Redis Rejected Connections
        expr: increase(redis_rejected_connections_total[1m]) > 0
        for: 5m
        labels:
          severity: error
        annotations:
          summary: "Rejected connections (instance {{ $labels.instance }})"
